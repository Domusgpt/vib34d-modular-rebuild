<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIB34D Modular Build - Module Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #0ff;
            font-family: 'Courier New', monospace;
        }
        h1 {
            color: #0ff;
            text-align: center;
        }
        .status {
            background: rgba(0,255,255,0.1);
            border: 1px solid #0ff;
            padding: 20px;
            margin: 20px auto;
            max-width: 900px;
        }
        .module {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0,255,255,0.05);
        }
        .success {
            color: #0f0;
        }
        .error {
            color: #f00;
        }
        #loading-indicator {
            text-align: center;
            padding: 40px;
        }
        #loading-indicator.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>üéØ VIB34D Modular Build - Phase 1 Complete</h1>

    <div id="loading-indicator">
        <div>‚è≥ Loading modules...</div>
    </div>

    <div class="status" id="module-status" style="display:none;">
        <h2>Module Load Status:</h2>
        <div id="status-content"></div>
    </div>

    <script type="module">
        import {
            RecordingEngine,
            AudioAnalyzer,
            Choreographer,
            applyParameterSweeps,
            applyColorPalette,
            applyChoreographyMode,
            PRESET_PALETTES,
            CHOREOGRAPHY_MODES,
            MODULES_LOADED
        } from './src/main.js';

        console.log('‚úÖ All imports successful!');
        console.log('Modules:', MODULES_LOADED);

        // Test that classes/functions can be accessed
        try {
            console.log('RecordingEngine class:', RecordingEngine);
            console.log('AudioAnalyzer class:', AudioAnalyzer);
            console.log('Choreographer class:', Choreographer);
            console.log('applyParameterSweeps function:', applyParameterSweeps);
            console.log('applyColorPalette function:', applyColorPalette);
            console.log('applyChoreographyMode function:', applyChoreographyMode);
            console.log('PRESET_PALETTES:', PRESET_PALETTES);
            console.log('CHOREOGRAPHY_MODES:', CHOREOGRAPHY_MODES);

            // Display success
            const statusContent = document.getElementById('status-content');
            statusContent.innerHTML = `
                <h3 style="color: #0f0; margin-bottom: 15px;">üéâ PHASE 1 COMPLETE - ALL MODULES LOADED!</h3>

                <div class="module success">‚úÖ <strong>RecordingEngine</strong>: ${typeof RecordingEngine === 'function' ? 'Class loaded' : 'ERROR'}</div>
                <div class="module success">‚úÖ <strong>AudioAnalyzer</strong>: ${typeof AudioAnalyzer === 'function' ? 'Class loaded' : 'ERROR'}</div>
                <div class="module success">‚úÖ <strong>Choreographer</strong>: ${typeof Choreographer === 'function' ? 'Class loaded (main orchestrator)' : 'ERROR'}</div>
                <div class="module success">‚úÖ <strong>applyParameterSweeps</strong>: ${typeof applyParameterSweeps === 'function' ? 'Function loaded (6 sweep types)' : 'ERROR'}</div>
                <div class="module success">‚úÖ <strong>applyColorPalette</strong>: ${typeof applyColorPalette === 'function' ? 'Function loaded (4 transition modes)' : 'ERROR'}</div>
                <div class="module success">‚úÖ <strong>applyChoreographyMode</strong>: ${typeof applyChoreographyMode === 'function' ? 'Function loaded (dispatches 10 modes)' : 'ERROR'}</div>

                <div class="module success" style="margin-top: 15px; padding: 15px; border: 1px solid #0f0;">
                    <strong>üì¶ PRESET_PALETTES:</strong> ${Object.keys(PRESET_PALETTES).length} palettes<br>
                    <small style="opacity: 0.8;">Available: ${Object.keys(PRESET_PALETTES).join(', ')}</small>
                </div>

                <div class="module success" style="margin-top: 10px; padding: 15px; border: 1px solid #0f0;">
                    <strong>üé≠ CHOREOGRAPHY_MODES:</strong> ${Object.values(CHOREOGRAPHY_MODES).length} modes<br>
                    <small style="opacity: 0.8;">Available: ${Object.values(CHOREOGRAPHY_MODES).join(', ')}</small>
                </div>

                <div style="margin-top: 25px; padding: 20px; background: rgba(0,255,0,0.1); border: 2px solid #0f0;">
                    <h3 style="margin-top: 0;">‚úÖ Phase 1: Core Module Extraction COMPLETE</h3>
                    <ul style="line-height: 1.8;">
                        <li>‚úÖ RecordingEngine.js - Video export with visualizer fixes</li>
                        <li>‚úÖ AudioAnalyzer.js - Beat detection & frequency analysis</li>
                        <li>‚úÖ ParameterSweeps.js - 6 algorithmic sweep functions</li>
                        <li>‚úÖ ColorPalettes.js - 4 transition modes + presets</li>
                        <li>‚úÖ ChoreographyModes.js - All 10 choreography modes</li>
                        <li>‚úÖ Choreographer.js - Main orchestrator (600+ lines)</li>
                    </ul>
                    <div style="margin-top: 15px; font-size: 14px;">
                        <strong>üöÄ Next Steps:</strong>
                        <ul>
                            <li>Import visualization engine classes</li>
                            <li>Create working index.html with full UI</li>
                            <li>Test end-to-end workflow</li>
                            <li>Deploy to GitHub Pages</li>
                        </ul>
                    </div>
                </div>

                <div style="margin-top: 15px; font-size: 11px; opacity: 0.7;">
                    <strong>Build System:</strong> Vite 5.4.20 with ES modules<br>
                    <strong>Dev Server:</strong> http://localhost:8765/vib34d-modular-rebuild/<br>
                    <strong>Total Extracted:</strong> ~3000 lines from 164KB monolithic file
                </div>
            `;

            document.getElementById('module-status').style.display = 'block';

            // Make modules globally available for debugging
            window.VIB34D = {
                RecordingEngine,
                AudioAnalyzer,
                Choreographer,
                applyParameterSweeps,
                applyColorPalette,
                applyChoreographyMode,
                PRESET_PALETTES,
                CHOREOGRAPHY_MODES,
                MODULES_LOADED
            };

            console.log('üîß Debug: window.VIB34D available for testing');

        } catch (error) {
            console.error('‚ùå Module test failed:', error);
            const statusContent = document.getElementById('status-content');
            statusContent.innerHTML = `
                <div class="module error">‚ùå <strong>Error:</strong> ${error.message}</div>
                <div class="module error"><pre>${error.stack}</pre></div>
            `;
            document.getElementById('module-status').style.display = 'block';
        }

        // Hide loading indicator
        document.getElementById('loading-indicator').classList.add('hidden');
    </script>
</body>
</html>
