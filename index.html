<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIB34D Sonic Atlas</title>
    <style>
        :root {
            --glass-bg: rgba(7, 12, 26, 0.72);
            --glass-highlight: rgba(43, 122, 255, 0.32);
            --glass-border: rgba(120, 230, 255, 0.45);
            --glass-border-strong: rgba(120, 230, 255, 0.75);
            --neon-cyan: #4dfcff;
            --neon-magenta: #ff72ff;
            --neon-amber: #ffce6b;
            --neon-lime: #8fffa8;
            --depth-dark: #03040d;
            --text-primary: rgba(230, 244, 255, 0.92);
            --text-secondary: rgba(210, 235, 255, 0.65);
            --text-muted: rgba(180, 220, 255, 0.42);
            --shadow-strong: 0 34px 120px rgba(5, 15, 45, 0.65);
            --shadow-soft: 0 18px 48px rgba(5, 15, 45, 0.35);
            --panel-radius: 22px;
            --hud-radius: 20px;
            --section-gap: clamp(18px, 2.6vw, 42px);
            --panel-gap: clamp(16px, 2vw, 32px);
            --transition: 220ms cubic-bezier(0.2, 0.8, 0.2, 1);
            --font-heading: 'Space Grotesk', 'Rubik', 'Inter', sans-serif;
            --font-body: 'Inter', 'IBM Plex Sans', sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-body);
            color: var(--text-primary);
            background: radial-gradient(120% 120% at 18% 12%, rgba(80, 240, 255, 0.14), transparent 60%),
                        radial-gradient(120% 120% at 82% 18%, rgba(255, 120, 255, 0.18), transparent 58%),
                        linear-gradient(140deg, #02030f 0%, #020211 35%, #050821 100%);
            min-height: 100vh;
            display: flex;
            align-items: stretch;
            justify-content: center;
            padding: clamp(16px, 2vw, 28px);
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: radial-gradient(70% 80% at 50% -10%, rgba(90, 200, 255, 0.12), transparent 65%),
                        radial-gradient(70% 80% at -10% 90%, rgba(255, 60, 160, 0.12), transparent 65%),
                        radial-gradient(90% 90% at 110% 90%, rgba(80, 255, 210, 0.08), transparent 70%);
            pointer-events: none;
            z-index: -2;
            filter: saturate(120%);
        }

        body::after {
            content: '';
            position: fixed;
            inset: 0;
            background: linear-gradient(0deg, rgba(0, 0, 0, 0.35), transparent 40%, transparent 60%, rgba(0, 0, 0, 0.45));
            pointer-events: none;
            z-index: -1;
        }

        body.canvas-pad-hold {
            background: radial-gradient(120% 120% at 18% 12%, rgba(80, 240, 255, 0.2), transparent 60%),
                        radial-gradient(120% 120% at 82% 18%, rgba(255, 120, 255, 0.24), transparent 58%),
                        linear-gradient(140deg, #02030f 0%, #04061a 38%, #070d28 100%);
        }

        #studio-shell {
            display: grid;
            grid-template-rows: auto 1fr auto;
            width: min(1800px, 100%);
            min-height: calc(100vh - clamp(16px, 2vw, 28px) * 2);
            border-radius: clamp(28px, 3vw, 42px);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(24px) saturate(140%);
            border: 1px solid rgba(120, 230, 255, 0.12);
            box-shadow: var(--shadow-strong);
        }

        #studio-shell::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(135deg, rgba(90, 210, 255, 0.18) 0%, rgba(255, 140, 240, 0.16) 45%, rgba(30, 40, 120, 0.28) 100%);
            opacity: 0.65;
            z-index: -1;
            filter: blur(18px);
        }

        .studio-top-bar {
            display: grid;
            grid-template-columns: minmax(220px, 280px) minmax(220px, 300px) minmax(260px, 1fr) minmax(260px, 320px) minmax(260px, 340px);
            align-items: center;
            gap: clamp(14px, 2vw, 28px);
            padding: clamp(18px, 2.4vw, 32px) clamp(28px, 3vw, 42px);
            background: rgba(6, 10, 24, 0.82);
            border-bottom: 1px solid rgba(120, 230, 255, 0.2);
            box-shadow: inset 0 -1px 0 rgba(120, 230, 255, 0.12);
        }

        .brand-block {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .brand-name {
            font-family: var(--font-heading);
            font-size: clamp(20px, 2.4vw, 30px);
            letter-spacing: 0.22em;
            text-transform: uppercase;
            color: var(--neon-cyan);
            text-shadow: 0 0 28px rgba(77, 252, 255, 0.55);
        }

        .brand-subtitle {
            font-size: clamp(12px, 1.4vw, 14px);
            text-transform: uppercase;
            letter-spacing: 0.4em;
            color: var(--text-muted);
        }

        .top-metrics {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 12px;
        }

        .metric-chip {
            background: linear-gradient(140deg, rgba(6, 12, 26, 0.92), rgba(16, 26, 52, 0.82));
            border-radius: 14px;
            padding: 14px 16px 12px;
            border: 1px solid rgba(120, 230, 255, 0.22);
            box-shadow: inset 0 0 12px rgba(90, 210, 255, 0.08);
            display: flex;
            flex-direction: column;
            gap: 6px;
            min-height: 68px;
        }

        .metric-chip span {
            display: block;
        }

        .metric-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.24em;
            color: var(--text-muted);
        }

        .metric-value {
            font-family: var(--font-heading);
            font-size: clamp(18px, 2vw, 24px);
        }

        .metric-bar {
            position: relative;
            width: 100%;
            height: 6px;
            background: rgba(120, 230, 255, 0.12);
            border-radius: 999px;
            overflow: hidden;
        }

        .metric-bar span {
            position: absolute;
            inset: 0;
            border-radius: inherit;
            background: linear-gradient(90deg, rgba(77, 252, 255, 0.1), rgba(77, 252, 255, 0.95));
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 180ms ease, filter 180ms ease;
        }

        .system-switch {
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .system-pill {
            background: linear-gradient(140deg, rgba(7, 14, 32, 0.8), rgba(18, 26, 48, 0.94));
            border: 1px solid rgba(120, 230, 255, 0.28);
            color: var(--text-secondary);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.18em;
            padding: 12px 18px;
            border-radius: 999px;
            cursor: pointer;
            transition: transform var(--transition), border-color var(--transition), color var(--transition), box-shadow var(--transition);
            backdrop-filter: blur(12px);
        }

        .system-pill:hover {
            border-color: var(--neon-cyan);
            color: var(--neon-cyan);
            transform: translateY(-2px);
            box-shadow: 0 18px 30px rgba(77, 252, 255, 0.22);
        }

        .system-pill.active {
            border-color: var(--glass-border-strong);
            color: var(--depth-dark);
            background: linear-gradient(135deg, rgba(77, 252, 255, 0.95), rgba(90, 210, 255, 0.82));
            box-shadow: 0 18px 36px rgba(77, 252, 255, 0.35);
        }

        .transport-cluster {
            display: grid;
            grid-template-columns: repeat(4, minmax(0, 1fr));
            gap: 12px;
            align-items: center;
        }

        .transport-btn {
            background: linear-gradient(160deg, rgba(8, 20, 38, 0.9), rgba(20, 36, 64, 0.9));
            border: 1px solid rgba(120, 230, 255, 0.25);
            border-radius: 16px;
            padding: 12px 0;
            color: var(--text-primary);
            font-size: 14px;
            letter-spacing: 0.15em;
            cursor: pointer;
            transition: transform var(--transition), background var(--transition), box-shadow var(--transition), border-color var(--transition);
            position: relative;
            overflow: hidden;
        }

        .transport-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 20% 20%, rgba(77, 252, 255, 0.2), transparent 55%);
            opacity: 0;
            transition: opacity var(--transition);
        }

        .transport-btn:hover::before {
            opacity: 1;
        }

        .transport-btn:hover {
            transform: translateY(-2px);
            border-color: rgba(120, 230, 255, 0.6);
            box-shadow: 0 18px 32px rgba(77, 252, 255, 0.25);
        }

        .transport-btn[data-state="active"] {
            background: linear-gradient(145deg, rgba(77, 252, 255, 0.9), rgba(120, 230, 255, 0.75));
            color: #01030f;
            border-color: rgba(120, 230, 255, 0.9);
            box-shadow: 0 18px 36px rgba(77, 252, 255, 0.4);
        }

        .audio-loader {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 12px;
        }

        .audio-loader button {
            background: linear-gradient(120deg, rgba(8, 18, 38, 0.92), rgba(18, 32, 58, 0.88));
            border: 1px solid rgba(120, 230, 255, 0.32);
            color: var(--text-primary);
            padding: 12px 18px;
            border-radius: 999px;
            letter-spacing: 0.18em;
            text-transform: uppercase;
            font-size: 11px;
            cursor: pointer;
            transition: var(--transition);
        }

        .audio-loader button:hover {
            border-color: var(--glass-border-strong);
            color: var(--neon-cyan);
            box-shadow: 0 18px 32px rgba(77, 252, 255, 0.25);
        }

        .audio-status {
            font-size: 11px;
            color: var(--text-secondary);
            letter-spacing: 0.18em;
            text-transform: uppercase;
        }

        .ai-mood-console {
            background: linear-gradient(150deg, rgba(7, 14, 34, 0.92), rgba(16, 28, 58, 0.88));
            border: 1px solid rgba(120, 230, 255, 0.22);
            border-radius: 18px;
            padding: 18px 20px;
            box-shadow: inset 0 0 32px rgba(77, 252, 255, 0.08);
            display: flex;
            flex-direction: column;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }

        .ai-mood-console::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 20% 15%, rgba(77, 252, 255, 0.12), transparent 55%),
                        radial-gradient(circle at 80% 85%, rgba(255, 120, 255, 0.1), transparent 60%);
            opacity: 0.8;
            pointer-events: none;
        }

        .ai-mood-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 12px;
            position: relative;
            z-index: 1;
        }

        .ai-mood-label {
            font-family: var(--font-heading);
            font-size: clamp(16px, 2vw, 22px);
            letter-spacing: 0.18em;
            text-transform: uppercase;
            color: var(--neon-cyan);
            text-shadow: 0 0 22px rgba(77, 252, 255, 0.4);
        }

        .ai-mood-energy {
            font-size: 11px;
            letter-spacing: 0.24em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .ai-mood-description {
            font-size: 0.88rem;
            color: rgba(220, 240, 255, 0.72);
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        .ai-mood-keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            position: relative;
            z-index: 1;
        }

        .ai-mood-keywords span {
            padding: 6px 10px;
            border-radius: 999px;
            background: rgba(77, 252, 255, 0.12);
            border: 1px solid rgba(120, 230, 255, 0.32);
            color: rgba(210, 240, 255, 0.82);
            font-size: 10px;
            letter-spacing: 0.22em;
            text-transform: uppercase;
        }

        .ai-mood-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            position: relative;
            z-index: 1;
        }

        .mood-trigger {
            background: linear-gradient(135deg, rgba(77, 252, 255, 0.2), rgba(255, 120, 255, 0.2));
            border: 1px solid rgba(120, 230, 255, 0.45);
            color: var(--text-primary);
            padding: 12px 18px;
            border-radius: 12px;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            font-size: 11px;
            cursor: pointer;
            transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
        }

        .mood-trigger:hover {
            transform: translateY(-2px);
            border-color: rgba(120, 230, 255, 0.8);
            box-shadow: 0 18px 36px rgba(77, 252, 255, 0.25);
        }

        .ai-mood-temperature {
            font-size: 11px;
            letter-spacing: 0.28em;
            text-transform: uppercase;
            color: var(--text-muted);
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            background: rgba(255, 255, 255, 0.06);
        }

        .ai-mood-temperature[data-temperature="warm"] {
            color: var(--neon-amber);
            border-color: rgba(255, 206, 107, 0.4);
        }

        .ai-mood-temperature[data-temperature="cool"] {
            color: var(--neon-cyan);
            border-color: rgba(77, 252, 255, 0.4);
        }

        .ai-mood-temperature[data-temperature="electric"],
        .ai-mood-temperature[data-temperature="neon"] {
            color: var(--neon-magenta);
            border-color: rgba(255, 114, 255, 0.4);
        }

        .ai-mood-temperature[data-temperature="sunrise"],
        .ai-mood-temperature[data-temperature="volcanic"] {
            color: var(--neon-amber);
            border-color: rgba(255, 180, 120, 0.4);
        }

        .studio-main {
            display: grid;
            grid-template-columns: minmax(260px, 320px) minmax(0, 1fr) minmax(300px, 360px);
            gap: var(--section-gap);
            padding: clamp(22px, 2.4vw, 38px);
            background: linear-gradient(160deg, rgba(6, 12, 30, 0.88), rgba(6, 12, 30, 0.68));
        }

        .studio-rail {
            display: flex;
            flex-direction: column;
            gap: var(--panel-gap);
        }

        .story-card {
            background: linear-gradient(150deg, rgba(8, 20, 40, 0.92), rgba(14, 26, 54, 0.85));
            border-radius: var(--panel-radius);
            border: 1px solid rgba(120, 230, 255, 0.18);
            padding: 24px;
            box-shadow: var(--shadow-soft);
            backdrop-filter: blur(16px);
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .story-card h2 {
            font-family: var(--font-heading);
            text-transform: uppercase;
            font-size: 16px;
            letter-spacing: 0.28em;
            color: var(--neon-cyan);
        }

        .scene-grid {
            display: grid;
            gap: 12px;
        }

        .scene-chip {
            display: grid;
            grid-template-columns: 1fr auto;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            border-radius: 16px;
            background: linear-gradient(120deg, rgba(14, 24, 48, 0.8), rgba(8, 18, 36, 0.7));
            border: 1px solid rgba(120, 230, 255, 0.18);
        }

        .scene-chip strong {
            font-family: var(--font-heading);
            letter-spacing: 0.12em;
            text-transform: uppercase;
            font-size: 12px;
        }

        .scene-chip span {
            font-size: 11px;
            color: var(--text-secondary);
            letter-spacing: 0.14em;
        }

        .scene-chip .scene-system {
            font-size: 10px;
            letter-spacing: 0.22em;
            text-transform: uppercase;
            color: var(--neon-amber);
        }

        .macro-board {
            display: grid;
            gap: 10px;
        }

        .macro-row {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            font-size: 12px;
            letter-spacing: 0.18em;
            color: var(--text-secondary);
        }

        .macro-row span:last-child {
            color: var(--neon-magenta);
            font-size: 11px;
        }

        .studio-stage {
            position: relative;
            border-radius: calc(var(--panel-radius) + 10px);
            overflow: hidden;
            box-shadow: 0 28px 100px rgba(3, 10, 26, 0.7);
        }

        .stage-frame {
            position: relative;
            border-radius: inherit;
            overflow: hidden;
            background: radial-gradient(circle at 50% 20%, rgba(40, 120, 255, 0.18), rgba(2, 4, 12, 0.95));
            border: 1px solid rgba(120, 230, 255, 0.22);
        }

        #stage-container {
            position: relative;
            width: 100%;
            min-height: clamp(480px, 55vw, 640px);
            border-radius: inherit;
            overflow: hidden;
            background: radial-gradient(circle at 50% 50%, rgba(18, 32, 60, 0.72), rgba(4, 8, 20, 0.92));
        }

        .stage-overlay {
            pointer-events: none;
            position: absolute;
            inset: 0;
            display: flex;
            justify-content: flex-end;
            align-items: flex-end;
            padding: 32px;
        }

        .sonic-hud {
            width: clamp(280px, 32vw, 360px);
            background: linear-gradient(145deg, rgba(6, 10, 24, 0.9), rgba(12, 18, 36, 0.78));
            border-radius: var(--hud-radius);
            border: 1px solid rgba(120, 230, 255, 0.35);
            box-shadow: 0 22px 60px rgba(8, 18, 46, 0.65);
            display: flex;
            flex-direction: column;
            gap: 18px;
            padding: 22px;
            backdrop-filter: blur(18px) saturate(160%);
        }

        .hud-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .hud-title {
            text-transform: uppercase;
            letter-spacing: 0.35em;
            font-size: 11px;
            color: var(--text-muted);
        }

        .hud-mode {
            font-family: var(--font-heading);
            font-size: 14px;
            letter-spacing: 0.3em;
            color: var(--neon-lime);
        }

        .hud-spectrum {
            display: grid;
            gap: 12px;
        }

        .hud-spectrum .channel-label {
            font-size: 10px;
            letter-spacing: 0.25em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .hud-spectrum .bar {
            width: 100%;
            height: 8px;
            border-radius: 999px;
            background: rgba(77, 252, 255, 0.08);
            overflow: hidden;
        }

        .hud-spectrum .bar span {
            display: block;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, rgba(77, 252, 255, 0.2), rgba(77, 252, 255, 0.95));
            transform: scaleX(0.2);
            transform-origin: left;
            transition: transform 180ms ease;
        }

        .hud-pad-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 12px;
        }

        .pad-card {
            padding: 12px 14px;
            border-radius: 14px;
            border: 1px solid rgba(120, 230, 255, 0.25);
            background: rgba(10, 18, 34, 0.8);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
            letter-spacing: 0.2em;
            text-transform: uppercase;
        }

        .pad-position {
            font-family: var(--font-heading);
            font-size: 13px;
            color: var(--neon-cyan);
        }

        .hold-indicator {
            font-size: 10px;
            letter-spacing: 0.22em;
            color: var(--text-secondary);
            transition: color 160ms ease, text-shadow 160ms ease;
        }

        .hold-indicator.is-active {
            color: var(--neon-magenta);
            text-shadow: 0 0 20px rgba(255, 114, 255, 0.6);
        }

        .hud-assignment {
            display: grid;
            gap: 8px;
            font-size: 10px;
            letter-spacing: 0.18em;
            text-transform: uppercase;
            color: var(--text-secondary);
        }

        .hud-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 10px;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--text-secondary);
        }

        .hud-footer strong {
            color: var(--neon-amber);
            font-size: 12px;
        }

        #studio-utility-rail {
            position: relative;
        }

        .studio-panel {
            background: linear-gradient(160deg, rgba(8, 16, 32, 0.92), rgba(12, 18, 38, 0.88));
            border-radius: var(--panel-radius);
            border: 1px solid rgba(120, 230, 255, 0.18);
            min-height: 280px;
            box-shadow: var(--shadow-soft);
            backdrop-filter: blur(18px);
            overflow: hidden;
            position: relative;
        }

        .studio-panel::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 15% 0%, rgba(77, 252, 255, 0.16), transparent 60%);
            pointer-events: none;
        }

        .panel-content {
            padding: 18px 24px 28px;
            max-height: 62vh;
            overflow-y: auto;
        }

        .panel-collapse-btn {
            position: absolute;
            top: 18px;
            right: 20px;
            width: 36px;
            height: 36px;
            border-radius: 12px;
            background: rgba(6, 12, 24, 0.85);
            border: 1px solid rgba(120, 230, 255, 0.28);
            color: var(--text-secondary);
            display: grid;
            place-items: center;
            cursor: pointer;
            font-size: 18px;
            transition: var(--transition);
        }

        .panel-collapse-btn:hover {
            color: var(--neon-cyan);
            border-color: rgba(120, 230, 255, 0.6);
            transform: translateY(-2px);
        }

        .panel-tab-label {
            padding: 28px 24px 18px;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.38em;
            color: var(--text-muted);
        }

        .collapsible-section {
            border-radius: 16px;
            border: 1px solid rgba(120, 230, 255, 0.18);
            margin-bottom: 16px;
            overflow: hidden;
            background: rgba(10, 18, 38, 0.72);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 18px;
            cursor: pointer;
            font-size: 12px;
            letter-spacing: 0.22em;
            text-transform: uppercase;
            color: var(--text-secondary);
            background: linear-gradient(135deg, rgba(6, 12, 24, 0.9), rgba(12, 20, 40, 0.86));
        }

        .section-header:hover {
            color: var(--neon-cyan);
            background: linear-gradient(135deg, rgba(6, 12, 24, 0.96), rgba(18, 28, 52, 0.92));
        }

        .section-content {
            padding: 18px;
            display: grid;
            gap: 14px;
            background: rgba(6, 12, 24, 0.8);
        }

        .slider-row {
            display: grid;
            grid-template-columns: 1fr 72px;
            gap: 12px;
            align-items: center;
        }

        .slider-row input[type="range"] {
            width: 100%;
        }

        .slider-row span {
            font-size: 12px;
            letter-spacing: 0.12em;
        }

        input[type="range"] {
            -webkit-appearance: none;
            height: 6px;
            border-radius: 999px;
            background: rgba(77, 252, 255, 0.12);
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--neon-cyan);
            box-shadow: 0 0 12px rgba(77, 252, 255, 0.6);
            cursor: pointer;
        }

        .xy-touchpad {
            position: relative;
            width: 100%;
            height: 260px;
            border-radius: 22px;
            border: 1px solid rgba(120, 230, 255, 0.24);
            background: radial-gradient(circle at 30% 30%, rgba(77, 252, 255, 0.12), transparent 60%),
                        linear-gradient(140deg, rgba(6, 12, 26, 0.9), rgba(12, 20, 40, 0.82));
            overflow: hidden;
            box-shadow: inset 0 0 0 1px rgba(120, 230, 255, 0.12);
            cursor: crosshair;
        }

        .xy-touchpad::after {
            content: '';
            position: absolute;
            inset: 10%;
            border: 1px dashed rgba(120, 230, 255, 0.2);
            border-radius: 18px;
        }

        .touchpad-controls {
            position: absolute;
            top: 14px;
            left: 14px;
            right: 14px;
            display: flex;
            gap: 12px;
            background: rgba(6, 12, 24, 0.88);
            border-radius: 16px;
            border: 1px solid rgba(120, 230, 255, 0.24);
            padding: 10px 12px;
            backdrop-filter: blur(10px);
            z-index: 3;
        }

        .touchpad-dropdown-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            letter-spacing: 0.12em;
            font-size: 10px;
            text-transform: uppercase;
        }

        .touchpad-dropdown {
            flex: 1;
            background: rgba(6, 12, 24, 0.92);
            border: 1px solid rgba(120, 230, 255, 0.24);
            color: var(--text-primary);
            border-radius: 999px;
            padding: 6px 12px;
            font-size: 11px;
        }

        .touchpad-cursor {
            position: absolute;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--neon-cyan);
            box-shadow: 0 0 18px rgba(77, 252, 255, 0.7);
            transform: translate(-50%, -50%);
            pointer-events: none;
        }

        .touchpad-hint {
            position: absolute;
            bottom: 18px;
            left: 18px;
            right: 18px;
            font-size: 10px;
            letter-spacing: 0.22em;
            text-transform: uppercase;
            color: var(--text-muted);
            text-align: center;
        }

        #performance-deck {
            background: linear-gradient(180deg, rgba(6, 12, 24, 0.9), rgba(2, 4, 12, 0.96));
            padding: clamp(20px, 2.6vw, 36px) clamp(26px, 3vw, 44px) clamp(32px, 3vw, 48px);
            display: flex;
            flex-direction: column;
            gap: clamp(22px, 2.2vw, 32px);
        }

        .deck-panels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: var(--panel-gap);
        }

        .deck-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--panel-gap);
        }

        .deck-card {
            background: linear-gradient(150deg, rgba(8, 18, 36, 0.92), rgba(10, 20, 40, 0.86));
            border-radius: var(--panel-radius);
            border: 1px solid rgba(120, 230, 255, 0.22);
            padding: 22px 24px 26px;
            box-shadow: var(--shadow-soft);
            backdrop-filter: blur(16px);
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .deck-card header {
            font-size: 12px;
            letter-spacing: 0.26em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .timeline-wrapper {
            display: grid;
            gap: 12px;
        }

        .timeline-bar {
            position: relative;
            width: 100%;
            height: 8px;
            border-radius: 999px;
            background: rgba(77, 252, 255, 0.1);
            overflow: hidden;
        }

        .timeline-bar span {
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, rgba(255, 114, 255, 0.18), rgba(77, 252, 255, 0.95));
            transform-origin: left;
            transform: scaleX(0);
            transition: transform 160ms ease;
        }

        .timecode {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: var(--font-heading);
            letter-spacing: 0.28em;
            font-size: 14px;
        }

        .trajectory-map {
            position: relative;
            height: 180px;
            border-radius: 18px;
            border: 1px solid rgba(120, 230, 255, 0.18);
            background: linear-gradient(140deg, rgba(8, 18, 36, 0.82), rgba(6, 12, 24, 0.92));
            overflow: hidden;
        }

        .trajectory-map::after {
            content: '';
            position: absolute;
            inset: 12px;
            border: 1px dashed rgba(120, 230, 255, 0.18);
            border-radius: 14px;
        }

        .trajectory-cursor {
            position: absolute;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--neon-magenta);
            box-shadow: 0 0 22px rgba(255, 114, 255, 0.6);
            transform: translate(-50%, -50%);
            transition: transform 120ms ease;
        }

        .trajectory-cursor[data-surface="canvas"] {
            background: var(--neon-cyan);
            box-shadow: 0 0 22px rgba(77, 252, 255, 0.55);
        }

        .surface-readouts {
            display: grid;
            gap: 10px;
        }

        .surface-readout {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            font-size: 12px;
            letter-spacing: 0.22em;
            text-transform: uppercase;
            color: var(--text-secondary);
        }

        .surface-readout strong {
            font-size: 14px;
            color: var(--neon-cyan);
        }

        #mode-display {
            background: transparent;
            border: none;
            padding: 0;
            gap: 18px;
        }

        #mode-display header {
            color: var(--neon-amber);
        }

        #mode-display .status-grid {
            display: grid;
            gap: 14px;
        }

        #mode-display .status-row {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            letter-spacing: 0.22em;
            text-transform: uppercase;
            font-size: 11px;
            color: var(--text-secondary);
        }

        #mode-display .status-row span:last-child {
            font-family: var(--font-heading);
            color: var(--text-primary);
        }

        .loading-indicator {
            position: fixed;
            inset: 0;
            display: grid;
            place-items: center;
            background: rgba(2, 4, 12, 0.92);
            z-index: 1000;
            backdrop-filter: blur(18px);
        }

        .loading-indicator.hidden {
            opacity: 0;
            pointer-events: none;
            transition: opacity 240ms ease;
        }

        .loading-card {
            background: linear-gradient(150deg, rgba(8, 18, 36, 0.95), rgba(6, 12, 26, 0.92));
            border-radius: 22px;
            border: 1px solid rgba(120, 230, 255, 0.35);
            padding: 32px 44px;
            text-align: center;
            box-shadow: 0 28px 60px rgba(3, 10, 26, 0.65);
        }

        .spinner {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 3px solid rgba(120, 230, 255, 0.2);
            border-top-color: rgba(120, 230, 255, 0.8);
            margin: 0 auto 18px;
            animation: spin 1s linear infinite;
        }

        .loading-card h3 {
            font-size: 14px;
            letter-spacing: 0.24em;
            text-transform: uppercase;
            color: var(--neon-cyan);
        }

        .loading-card p {
            margin-top: 10px;
            font-size: 12px;
            color: var(--text-secondary);
            letter-spacing: 0.16em;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Layout states */
        body[data-layout="wide"] .studio-top-bar {
            grid-template-columns: minmax(200px, 240px) minmax(200px, 240px) minmax(240px, 1fr) minmax(220px, 280px) minmax(220px, 280px);
        }

        body[data-layout="wide"] .studio-main {
            grid-template-columns: minmax(240px, 300px) minmax(0, 1fr) minmax(280px, 320px);
        }

        body[data-layout="compact"] .studio-top-bar {
            grid-template-columns: minmax(200px, 1fr) minmax(220px, 1fr);
            grid-template-rows: auto auto;
        }

        body[data-layout="compact"] .ai-mood-console,
        body[data-layout="compact"] .transport-cluster {
            grid-column: 1 / -1;
        }

        body[data-layout="compact"] .brand-block {
            grid-column: 1 / -1;
        }

        body[data-layout="compact"] .system-switch {
            justify-content: flex-start;
        }

        body[data-layout="compact"] .studio-main {
            grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
        }

        body[data-layout="compact"] #studio-utility-rail {
            grid-column: 1 / -1;
            flex-direction: row;
            flex-wrap: wrap;
            gap: var(--panel-gap);
        }

        body[data-layout="compact"] .studio-panel {
            flex: 1 1 320px;
        }

        body[data-layout="stacked"] {
            padding: clamp(12px, 4vw, 24px);
        }

        body[data-layout="stacked"] #studio-shell {
            border-radius: clamp(18px, 4vw, 28px);
        }

        body[data-layout="stacked"] .studio-top-bar {
            grid-template-columns: 1fr;
            grid-template-rows: repeat(4, auto);
        }

        body[data-layout="stacked"] .studio-main {
            grid-template-columns: 1fr;
        }

        body[data-layout="stacked"] #studio-utility-rail,
        body[data-layout="stacked"] .studio-rail {
            flex-direction: column;
        }

        body[data-layout="stacked"] .studio-panel {
            flex: 1 1 auto;
        }

        body[data-layout="stacked"] .deck-grid {
            grid-template-columns: 1fr;
        }

        /* Orientation adjustments */
        body[data-orientation="portrait"] .studio-top-bar {
            grid-template-columns: 1fr;
        }

        body[data-orientation="portrait"] .studio-main {
            grid-template-columns: 1fr;
        }
    </style>
</head>
<body data-layout="panorama" data-orientation="landscape">
    <div id="studio-shell">
        <header id="top-bar" class="studio-top-bar">
            <div class="brand-block">
                <span class="brand-name">VIB34D</span>
                <span class="brand-subtitle">Sonic Atlas Control Surface</span>
                <span class="audio-status" id="audio-status">No audio loaded</span>
            </div>
            <div class="top-metrics">
                <div class="metric-chip">
                    <span class="metric-label">Energy Sculpt</span>
                    <span class="metric-value" data-metric-value="energy">0%</span>
                    <div class="metric-bar"><span data-metric-bar="energy"></span></div>
                </div>
                <div class="metric-chip">
                    <span class="metric-label">Intensity Blend</span>
                    <span class="metric-value" data-metric-value="intensity">0%</span>
                    <div class="metric-bar"><span data-metric-bar="intensity"></span></div>
                </div>
            </div>
            <div class="ai-mood-console" aria-live="polite">
                <div class="ai-mood-header">
                    <span class="ai-mood-label" id="sonic-mood-label">Manual Sculpt</span>
                    <span class="ai-mood-energy" id="sonic-mood-energy">50% ENERGY</span>
                </div>
                <p class="ai-mood-description" id="sonic-mood-description">
                    Describe a feeling to sculpt the stage with holographic motion.
                </p>
                <div class="ai-mood-keywords" id="sonic-mood-keywords">
                    <span>adaptive</span>
                    <span>audio-linked</span>
                </div>
                <div class="ai-mood-footer">
                    <button class="mood-trigger" data-action="launch-ai-mood">Design Sonic Mood</button>
                    <span class="ai-mood-temperature" id="sonic-mood-temperature" data-temperature="ambient">AMBIENT</span>
                </div>
            </div>
            <div class="system-switch" aria-label="Visualizer Systems">
                <button class="system-pill active" data-system="faceted">Faceted Core</button>
                <button class="system-pill" data-system="quantum">Quantum Bloom</button>
                <button class="system-pill" data-system="holographic">Holographic Flux</button>
            </div>
            <div class="transport-cluster">
                <button class="transport-btn" data-transport="play">Play</button>
                <button class="transport-btn" data-transport="pause">Pause</button>
                <button class="transport-btn" data-transport="stop">Stop</button>
                <div class="audio-loader">
                    <button data-action="load-audio">Load Audio</button>
                    <input type="file" id="audio-file-input" accept="audio/*" hidden>
                </div>
            </div>
        </header>

        <div class="studio-main">
            <aside class="studio-rail">
                <div class="story-card">
                    <h2>Setlist Flow</h2>
                    <div class="scene-grid">
                        <div class="scene-chip">
                            <div>
                                <strong>Ignition Pulse</strong>
                                <span>Intro lift-off</span>
                            </div>
                            <span class="scene-system">FACETED</span>
                        </div>
                        <div class="scene-chip">
                            <div>
                                <strong>Quantum Bloom</strong>
                                <span>Expansive chorus</span>
                            </div>
                            <span class="scene-system">QUANTUM</span>
                        </div>
                        <div class="scene-chip">
                            <div>
                                <strong>Holo Echo</strong>
                                <span>Ambient bridge</span>
                            </div>
                            <span class="scene-system">HOLOGRAPHIC</span>
                        </div>
                    </div>
                    <div class="macro-board">
                        <div class="macro-row"><span>Scene Morph</span><span>Audio locked</span></div>
                        <div class="macro-row"><span>Color Orbit</span><span>Synced</span></div>
                        <div class="macro-row"><span>Rotation Bank</span><span>Adaptive</span></div>
                    </div>
                </div>
            </aside>

            <main class="studio-stage">
                <div class="stage-frame">
                    <div id="stage-container"></div>
                    <div id="holographic-overlay" class="stage-overlay">
                        <div class="sonic-hud" id="sonic-hud">
                            <div class="hud-header">
                                <span class="hud-title">Sonic Sculptor</span>
                                <span class="hud-mode" data-hud="mode">INIT</span>
                            </div>
                            <div class="hud-spectrum">
                                <div>
                                    <div class="channel-label">Bass</div>
                                    <div class="bar" data-channel="bass"><span></span></div>
                                </div>
                                <div>
                                    <div class="channel-label">Mid</div>
                                    <div class="bar" data-channel="mid"><span></span></div>
                                </div>
                                <div>
                                    <div class="channel-label">High</div>
                                    <div class="bar" data-channel="high"><span></span></div>
                                </div>
                                <div>
                                    <div class="channel-label">Energy</div>
                                    <div class="bar" data-channel="energy"><span></span></div>
                                </div>
                            </div>
                            <div class="hud-pad-grid">
                                <div class="pad-card">
                                    <div>
                                        <div>Controller Pad</div>
                                        <div class="pad-position" data-pad="controller">50%, 50%</div>
                                    </div>
                                    <div class="hold-indicator" data-hold="controller">LIVE</div>
                                </div>
                                <div class="pad-card">
                                    <div>
                                        <div>Canvas Pad</div>
                                        <div class="pad-position" data-pad="canvas">50%, 50%</div>
                                    </div>
                                    <div class="hold-indicator" data-hold="canvas">LIVE</div>
                                </div>
                            </div>
                            <div class="hud-assignment">
                                <div>Controller X → <span data-assignment="controller-x">chaos</span></div>
                                <div>Controller Y → <span data-assignment="controller-y">speed</span></div>
                                <div>Canvas X → <span data-assignment="canvas-x">rot4dYW, glitchIntensity</span></div>
                                <div>Canvas Y → <span data-assignment="canvas-y">rot4dXW, intensity</span></div>
                            </div>
                            <div class="hud-footer">
                                <span>Intensity <strong data-hud="intensity">50%</strong></span>
                                <span>Audio Reactivity</span>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <aside class="studio-rail" id="studio-utility-rail">
                <div id="control-panel" class="studio-panel"></div>
                <div id="visuals-panel" class="studio-panel"></div>
            </aside>
        </div>

        <section id="performance-deck">
            <div class="deck-panels" id="deck-panel-dock"></div>
            <div class="deck-grid">
                <article class="deck-card">
                    <header>Transport &amp; Macro Sculpt</header>
                    <div class="timeline-wrapper">
                        <div class="timeline-bar"><span data-progress></span></div>
                        <div class="timecode" data-timecode>
                            <span data-time="current">00:00</span>
                            <span data-time="duration">--:--</span>
                        </div>
                        <div class="surface-readouts">
                            <div class="surface-readout">
                                <span>System</span>
                                <strong id="current-system">FACETED</strong>
                            </div>
                            <div class="surface-readout">
                                <span>Mode</span>
                                <strong id="current-mode">IDLE</strong>
                            </div>
                        </div>
                    </div>
                </article>

                <article class="deck-card">
                    <header>Expressive Trajectories</header>
                    <div class="trajectory-map" aria-hidden="true">
                        <div class="trajectory-cursor" data-surface="controller"></div>
                        <div class="trajectory-cursor" data-surface="canvas"></div>
                    </div>
                    <div class="surface-readouts">
                        <div class="surface-readout">
                            <span>Controller XY</span>
                            <strong data-pad-readout="controller">50 · 50</strong>
                        </div>
                        <div class="surface-readout">
                            <span>Canvas XY</span>
                            <strong data-pad-readout="canvas">50 · 50</strong>
                        </div>
                    </div>
                    <div id="controller-pad-zone"></div>
                </article>

                <article class="deck-card" id="mode-display">
                    <header>Choreography Status</header>
                    <div class="status-grid">
                        <div class="status-row">
                            <span>Audio</span>
                            <span id="audio-status-bottom">Disconnected</span>
                        </div>
                        <div class="status-row">
                            <span>Sequences</span>
                            <span id="sequence-count">0</span>
                        </div>
                    </div>
                </article>
            </div>
        </section>
    </div>

    <div id="loading-indicator" class="loading-indicator">
        <div class="loading-card">
            <div class="spinner"></div>
            <h3>Booting Sonic Atlas</h3>
            <p>Initializing choreography engines...</p>
        </div>
    </div>

    <script type="module" src="src/main.js"></script>
</body>
</html>
